<nav class="bg-neutral-primary fixed w-full z-20 top-0 start-0 border-b border-default">
  <div class="max-w-7xl flex items-center mx-auto p-4">

    <!-- ===== LOGO ===== -->
    <a routerLink="/home" class="flex items-center space-x-3 rtl:space-x-reverse">
      <img src="/images/freshcart-logo.svg" alt="Logo">
    </a>

    <!-- ===== LINKS CENTER (hidden on mobile, shown on md+) ===== -->
    <div class="hidden md:flex flex-1 justify-center">
      <ul class="font-medium flex flex-row items-center gap-4">

        <!-- PUBLIC LINKS -->
        <li>
          <a routerLink="/home" routerLinkActive="active-link" class="block py-2 px-3 capitalize">Home</a>
        </li>
        <li>
          <a routerLink="/products" routerLinkActive="active-link" class="block py-2 px-3 capitalize">Products</a>
        </li>
        <li>
          <a routerLink="/categories" routerLinkActive="active-link" class="block py-2 px-3 capitalize">Categories</a>
        </li>
        <li>
          <a routerLink="/brands" routerLinkActive="active-link" class="block py-2 px-3 capitalize">Brands</a>
        </li>


        <!-- AUTH LINKS -->
        @if (isLogin$ | async) {
        <li>
          <a class="block relative py-2 px-3 capitalize" routerLink="/cart" routerLinkActive="active-link">
            Cart
            @if(cartService.numOfCartItems | async){
            <div
              class="absolute inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-600 border-2 border-white rounded-full -top-2 -end-2">
              {{cartService.numOfCartItems | async}}
            </div>
            }
          </a>
        </li>
        <li>
          <a class="block relative py-2 px-3 capitalize" routerLink="/wishlist" routerLinkActive="active-link">
            Wishlist
            @if(count){
            <div
              class="absolute inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-600 border-2 border-buffer rounded-full -top-2 -end-2">
              <span>{{ count }}</span>

            </div>
            }
          </a>
        </li>
        }
      </ul>
    </div>

    <!-- ===== ACTIONS RIGHT â€” desktop ===== -->
    <div class="hidden md:flex items-center gap-4">
      @if (isLogin$ | async) {

      <button type="button" (click)="isUserDropdownOpen = !isUserDropdownOpen" class="inline-flex items-center justify-center text-white bg-fg-lime hover:bg-fg-lime
         focus:ring-4 focus:ring-brand-medium shadow-xs font-medium leading-5
         rounded-base text-sm px-4 py-2.5 focus:outline-none">

        User
        <svg class="w-4 h-4 ms-1.5 transition-transform" [class.rotate-180]="isUserDropdownOpen" viewBox="0 0 24 24"
          fill="none">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="m19 9-7 7-7-7" />
        </svg>
      </button>


      <!-- Dropdown menu -->
      @if (isUserDropdownOpen) {
      <div class="absolute right-10 top-13.75 mt-2 z-20 bg-neutral-primary-medium
           border border-default-medium rounded-base shadow-lg w-44">

        <ul class="p-2 text-sm text-body font-medium">

          <li>
            <a routerLink="/allorders" (click)="isUserDropdownOpen = false" class="flex items-center w-full p-2 hover:bg-neutral-tertiary-medium
                 hover:text-heading rounded cursor-pointer">
              My Orders
            </a>
          </li>
          <li>
            <a routerLink="/change-password" (click)="isUserDropdownOpen = false" class="flex items-center w-full p-2 hover:bg-neutral-tertiary-medium
                 hover:text-heading rounded cursor-pointer">
              Change Password
            </a>
          </li>




          <li>
            <button (click)="logOut(); isUserDropdownOpen = false" class="w-full text-left p-2 hover:bg-neutral-tertiary-medium
                 hover:text-heading rounded cursor-pointer">
              Logout
            </button>
          </li>
        </ul>
      </div>
      }




      } @else {
      <a routerLink="/login" class="py-2 px-3 capitalize">Login</a>
      <a routerLink="/register" class="py-2 px-3 capitalize">Register</a>
      }
    </div>

    <!-- ===== MOBILE HAMBURGER (visible only on mobile) ===== -->
    <button type="button" (click)="isMobileMenuOpen = !isMobileMenuOpen"
      class="ml-auto inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-body rounded-base md:hidden hover:bg-neutral-secondary-soft hover:text-heading focus:outline-none focus:ring-2 focus:ring-neutral-tertiary"
      aria-controls="mobile-menu" [attr.aria-expanded]="isMobileMenuOpen ? 'true' : 'false'">
      <span class="sr-only">{{ isMobileMenuOpen ? 'Close main menu' : 'Open main menu' }}</span>

      <!-- Hamburger icon -->
      @if (!isMobileMenuOpen) {
      <svg class="w-6 h-6" viewBox="0 0 24 24">
        <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 7h14M5 12h14M5 17h14" />
      </svg>
      }
      <!-- X icon -->
      @if (isMobileMenuOpen) {
      <svg class="w-6 h-6" viewBox="0 0 24 24">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M6 18L18 6M6 6l12 12" />
      </svg>
      }
    </button>

  </div>

  <!-- ===== MOBILE MENU DROPDOWN ===== -->
  @if (isMobileMenuOpen) {
  <div id="mobile-menu"
    class="md:hidden border-t border-default bg-neutral-secondary-soft px-4 py-3 flex flex-col gap-1">

    <!-- Nav links -->
    <a routerLink="/home" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Home</a>
    <a routerLink="/products" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Products</a>
    <a routerLink="/categories" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Categories</a>
    <a routerLink="/brands" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Brands</a>

    <!-- Auth links -->
    @if (isLogin$ | async) {
    <a routerLink="/cart" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block relative py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">
      Cart
      @if(cartService.numOfCartItems | async){
      <span
        class="inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-danger border-2 border-buffer rounded-full ml-2">
        {{cartService.numOfCartItems | async}}
      </span>
      }
    </a>
    <a routerLink="/wishlist" routerLinkActive="active-link" (click)="isMobileMenuOpen = false"
      class="block relative py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">
      Wishlist
      @if(wishlistService.numOfWishListItems){
      <span
        class="inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-danger border-2 border-buffer rounded-full ml-2">
        {{wishlistService.numOfWishListItems}}
      </span>
      }
    </a>

    <!-- Divider -->
    <hr class="border-default my-1">

    <a routerLink="/change-password" (click)="isUserDropdownOpen = false" class="flex items-center w-full p-2 hover:bg-neutral-tertiary-medium
                 hover:text-heading rounded cursor-pointer">
      Change Password
    </a>

    <button (click)="logOut(); isMobileMenuOpen = false"
      class="block text-left py-2 px-3 capitalize  hover:text-heading rounded cursor-pointer hover:bg-neutral-tertiary-medium">
      Logout
    </button>
    } @else {
    <hr class="border-default my-1">
    <a routerLink="/login" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Login</a>
    <a routerLink="/register" (click)="isMobileMenuOpen = false"
      class="block py-2 px-3 capitalize rounded-base hover:bg-neutral-secondary">Register</a>
    }
  </div>
  }

</nav>